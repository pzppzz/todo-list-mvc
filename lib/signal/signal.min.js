!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Dispose={})}(this,(function(t){"use strict";"function"==typeof SuppressedError&&SuppressedError;var e=function(){function t(){this._group=new Set,this._disposed=!1}return t.prototype._clear=function(){this._group.forEach((function(t){t.dispose()})),this._group.clear()},Object.defineProperty(t.prototype,"disposed",{get:function(){return this._disposed},enumerable:!1,configurable:!0}),t.prototype.add=function(t){if("function"!=typeof(null==t?void 0:t.dispose))throw new TypeError("".concat(t," is not a valid disposable object!"));if(this._disposed)return t.dispose(),t;if(t===this)throw new Error("Cannot add a disposable to itself.");return this._group.add(t),t},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._clear())},Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._group.size},enumerable:!1,configurable:!0}),t.prototype.addFromNative=function(t,e,n,o){return this.add({dispose:function(){t.removeEventListener(e,n,o)}}),t.addEventListener(e,n,o),this},t}(),n=function(t){this.action=t},o=function(){function t(){this._listeners=[],this._disposed=!1}return t.prototype._connect=function(t,o,i,r){var s=this;if(!this._disposed){if("function"!=typeof t)throw console.error("".concat(t," is not a valid function!")),new TypeError("listener must be a function");var p=t=o?t.bind(o):t;if(r){var c=!1;p=function(e){c||(c=!0,t(e),s._disconnect(d))}}var d=new n(p),u={dispose:function(){d&&(s._disconnect(d),d=null)}};return i instanceof e?i.add(u):Array.isArray(i)&&i.push(u),this._listeners.push(d),u}console.warn("Cannot connect to a disposed signal!")},t.prototype._disconnect=function(t){var e=this._listeners;if(e.length){for(var n=!1,o=0;o<e.length;o++)n?e[o-1]=e[o]:t===e[o]&&(n=!0);n&&e.length--}},t.prototype.connect=function(t,e,n){return this._connect(t,e,n)},t.prototype.once=function(t,e){return this._connect(t,e,void 0,!0)},t.prototype.trigger=function(t){if(this._listeners.length)for(var e=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))}([],this._listeners,!0),n=0;n<e.length;n++)e[n].action(t)},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._listeners=[])},Object.defineProperty(t.prototype,"hasListener",{get:function(){return this._listeners.length>0},enumerable:!1,configurable:!0}),t}();t.DisposableGroup=e,t.Signal=o}));
